package s3;

import java.util.UUID;
import java.util.List;
import java.net.URL;
import java.net.MalformedURLException;
import org.json.JSONObject;
import org.json.JSONException;

import com.amazonaws.services.sqs.AmazonSQS;
import com.amazonaws.services.sqs.model.*;

import com.amazonaws.services.sqs.AmazonSQSClientBuilder;

public class Accessor {
	public void receive_messages_from_sqs() {
		 // Receive messages.
		final AmazonSQS sqs = AmazonSQSClientBuilder.defaultClient();
		URL myQueueUrl=null;
		try {
			myQueueUrl = new URL("https://sqs.us-east-1.amazonaws.com/537655468469/input.fifo");
		} catch (MalformedURLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		String U = myQueueUrl.toString();
       System.out.println("Receiving messages from MyFifoQueue.fifo.\n");
       final ReceiveMessageRequest receiveMessageRequest = new ReceiveMessageRequest(U);

       // Uncomment the following to provide the ReceiveRequestDeduplicationId
       //receiveMessageRequest.setReceiveRequestAttemptId("1");
       final List<Message> messages = sqs.receiveMessage(receiveMessageRequest)
               .getMessages();
       for (final Message message : messages) {
           System.out.println("Message");
           System.out.println("  MessageId:     " + message.getMessageId());
           System.out.println("  ReceiptHandle: " + message.getReceiptHandle());
           System.out.println("  MD5OfBody:     " + message.getMD5OfBody());
           System.out.println("  Body:          " + message.getBody());
//           for (final Entry<String, String> entry : message.getAttributes()
//                   .entrySet()) {
//               System.out.println("Attribute");
//               System.out.println("  Name:  " + entry.getKey());
//               System.out.println("  Value: " + entry.getValue());
//           }
       }
       System.out.println();
	}

}
